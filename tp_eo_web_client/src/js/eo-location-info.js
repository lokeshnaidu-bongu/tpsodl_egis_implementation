/*! ElectricOfficeWeb 5.0.1 2021-06-16 */
define(["jquery","underscore","i18n!nls/messages","hogan","comms","text!partials/eo-location-info.html","map-loader"],function(a,b,c,d,e,f,g){"use strict";var h,i="eo_location_info",j=d.compile(f),k=function(){a.subscribe("objectDetailsBoxReady",l),a.subscribe("showObjectDetails",m)},l=function(a,b){a===i&&n(b,{id:a})},m=function(a){o(a.urn)};b.each(g.ObjectDetails.layout,function(a){if(a.name===i)return void k()});var n=function(a){h=a,h.html(j.render({features:0,messages:c,infoMessages:c.object_details.nothingSelected}))},o=function(a){p(a)},p=function(a){var b={json:!0,service:"ejb/MapLocationLocal",method:"getRWOmapLocation",urn:a};e.getGSSRequest(b,q,r)},q=function(d){var e={areas:[]},f=[],g=0,i=0;b.each(d,function(a){b.each(a,function(a){f.indexOf(a.name)<0?(f.push(a.name),i=g,e.areas[i]={joins:[],name:a.name},g++):i=f.indexOf(a.name),e.areas[i].joins.push(a)})}),h.empty(),h.append(j.render({features:e.areas.length?e:0,messages:c,infoMessage:c.object_details.eoLocationInfo.noDataMessage})),a("div.join",h).click(function(){a.publish("showObjectDetails",[{urn:this.id}])})},r=function(b){a.publish("raiseStickyMessage",[c.map_location.requestFaild,{messageType:"warning",errorMessage:b.responseText}])},s={};return s.__TEST_ONLY__={doRequest:o,locationDataCallback:q,getLocationData:p,setBoxSelector:function(a){h=a},getBoxSelector:function(){return h}},s});