/*! ElectricOfficeWeb 5.0.1 2021-06-16 */
define(["jquery","map-loader","map-helper","map-core-component/pubsub"],function(a,b,c){"use strict";var d,e,f={},g=2,h=0,i=3,j=1,k=navigator.language||navigator.userLanguage,l=/^http:|https:/,m="http://nominatim.openstreetmap.org/search",n="http://nominatim.openstreetmap.org/reverse",o=function(a,b){d=b,e=c.mapProj};a.subscribe("mapInitialised",o);var p=function(c,d){var e=(b.OSM.AddressURL||m).replace(l,location.protocol);a.ajax({data:{"accept-language":k,format:"json",limit:10,q:c},url:e,async:!0,dataType:"jsonp",jsonp:"json_callback",success:function(b){d(a.map(b,function(a){return f[a.display_name]=a,{value:a.display_name}}))}})},q=function(a,b,e){var k,l=f[a.value].boundingbox,m=c.transformToMapProjection([l[g],l[h]]),n=c.transformToMapProjection([l[i],l[j]]);k=m.concat(n),c.fitMapToBounds(d,k)},r=function(c,d,e){var f=(b.OSM.ReverseGeoUrl||n).replace(l,location.protocol);a.ajax({data:{"accept-language":k,format:"json",lat:c,lon:d},async:!0,dataType:"jsonp",jsonp:"json_callback",url:f,success:function(a){e(a.display_name,a)}})},s=function(a){return a=a||{mapName:"default",placeHolderText:"Address Search"},{icon:"icon-map-marker",placeholderText:a.placeHolderText||"",searchOptions:{isFaceted:!1,mapNames:[a.mapName],positionElementID:"searchSubmitBtn",source:p,type:"custom",viewItemCallback:q,highlighter:function(a){var b=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return a.replace(new RegExp("("+b+")","ig"),function(a,b){return"<strong>"+b+"</strong>"})}}}},t={getDefaultContext:s,reverseGeocode:r};return t.__TEST_ONLY__={setMap:o,getMap:function(){return d},searchAddresses:p,gotoAddressCallback:q},t});