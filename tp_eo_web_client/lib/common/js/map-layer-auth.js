/*! ElectricOfficeWeb 5.0.1 2021-06-16 */
define(["jquery","underscore","comms","map-helper","i18n!viewer/nls/messages","map-core-component/pubsub"],function(a,b,c,d,e){var f,g=function(b){f=[],a.each(b.layers,function(b,c){a.each(c,function(a,b){f.push(b)})}),a.publish("retrievedAuthorizedLayers")},h=function(b){a.publish("raiseStickyMessage",[e.map_layers.requestFailed,{messageType:"error",errorMessage:b.responseText}])},i=function(a,b){var d={dataType:"json",url:"/maps/layers"};c.getNodeRequest(d,a,b)};a.subscribe("authCheckComplete",function(){i(g,h)});var j=function(c){var e=[],g=function(a,b,c){f.indexOf(b)>=0&&e.push({layer:a,InternalLayerName:b,ExternalLayerName:c})};return a.each(c,function(a,c){var e=d.authGroups(c.InternalLayerName);e?b.each(e,function(a){var b=c.InternalLayerName+"!auth!"+a.scope;g(c,b,a.name)}):g(c,c.InternalLayerName,c.ExternalLayerName)}),e},k={getAuthorizedLayers:j};return k});